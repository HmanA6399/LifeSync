# Routes and procedures specification

| Route                                                   | verb   | StoredProc                                                   | Parameters                                                                                                                                                                                                                                                                                                                                                                                 | Returns                                                                                                         |
| ------------------------------------------------------- | ------ | ------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------- |
| /user/:id                                               | GET    | `GetUser(id)`                                                | `id` : ID of the user to return                                                                                                                                                                                                                                                                                                                                                            | All _attributes_ of _Person_                                                                                    |
| /user                                                   | POST   | `AddUser(data)`                                              | `data`: All or some values for the _attributes_ of the _Person_ relation - must include values for all non-nullable _attributes_                                                                                                                                                                                                                                                           | `NULL`                                                                                                          |
| /user/:id                                               | POST   | `SetUser(id, data)`                                          | `id`: ID of the _Person_ to edit<br /> `data`: All or some values for the _attributes_ of the _Person_ relation, they're given in the order of the schema definition with nulls for the data we don't need to edit                                                                                                                                                                         | `NULL`                                                                                                          |
| /user/:id                                               | DELETE | `DeleteUser(id)`                                             | `id`: ID of the _Person_ we want to delete                                                                                                                                                                                                                                                                                                                                                 | `NULL`                                                                                                          |
| /user/:id/info                                          | GET    | `GetUserInfo(id)`                                            | `id`: ID of _Person_ to return _Info_ of                                                                                                                                                                                                                                                                                                                                                   | All (key,value) paired _Info_ of the given _Person_                                                             |
| /user/:id/allergies                                     | GET    | GetUserAllergies(id)                                         | `id`: ID of the _Person_ to get allergies of                                                                                                                                                                                                                                                                                                                                               | `name` attribute of all the attributes the user has - Recall that allergies are in fact of type _Disease_       |
| /user/:id/allergy/:allergyId                            | DELETE | DeleteUserAllergy(personId, allergyId)                       | `personId`: ID of the _Person_ to delete allergy of<br>`allergyID`: ID of the allergy to delete to the given user - if found                                                                                                                                                                                                                                                               |
| /user/:id/info                                          | POST   | `SetUserInfo(id, key, value)`                                | `id`: ID of the _Person_ to add or overwrite this _Info_ pair to <br> `key`: value of the _key_ attribute to add or overwrite <br> `value`: value of the _value_ attribute                                                                                                                                                                                                                 | `NULL`                                                                                                          |
| /user/:id/info/:key                                     | DELETE | `DeleteUserInfo(id, key)`                                    | `id`: ID of the _Person_ to delete this _Info_ pair to <br> `key` : value of the _key_ attribute of the _Info_ to delete                                                                                                                                                                                                                                                                   | `NULL`                                                                                                          |
| /user/:id/schedule/:date                                | GET    | `GetUserDaySchedule(id, date)`                               | `id`: ID of the _Person_ to get TimeSlot of<br> `date` : value of the candidate key attribute _date_ of the _Schedule_Timeslot_ relation <br>                                                                                                                                                                                                                                              | `NULL`                                                                                                          |
| /user/:id/schedule/:date/:start                         | POST   | `SetUserDayTS(id, day, start, end, todo)`                    | `id`: ID of the _Person_ to add or overwrite TimeSlot to<br> `date` : value of the candidate key attribute _date_ of the _Schedule_Timeslot_ relation to add/overwrite this slot to<br> `start`: value of the candidate key attribute _start_ of the _Schedule_Timeslot_ relation to add/overwrite this slot to<br> `end`, `todo`: values of other _Schedule_Timeslot_ relation attributes | `NULL`                                                                                                          |
| /projects/:idx                                          | GET    | `GetProjects(startIndex)`                                    | `startIndex` : We want to retrieve at most 20 projects starting from this index in the DB                                                                                                                                                                                                                                                                                                  | Returns _title_, _thumbnail_, _describtion_ of the at most 20 _Project_(s) starting from the given `startIndex` |
| /project/:projId                                        | GET    | `GetProject(projId)`                                         | `projId` : _Project_ ID to get                                                                                                                                                                                                                                                                                                                                                             | Returns all the attributes of the _Project_ relation of the given project                                       |
| /project/:projectId/contributors                        | GET    | `GetProjectContributors(projId)`                             | `projId`: ID of the project to retrieve contributors for                                                                                                                                                                                                                                                                                                                                   | Returns IDs for all _Person_(s) that are contributors to the given project                                      |
| /project/:projectId/imgsVids                            | GET    | `GetProjectImgsAndVids(projId)`                              | `projId`: ID of the project to retrieve images and videos for                                                                                                                                                                                                                                                                                                                              | Returns links for all imgs and videos of the given project                                                      |
| /user/:personId/projects                                | POST   | `AddUserProject(personId, data)`                             | `personId`: ID of the admin/owner of the project<br>`data` : values for all or some attributes of the _Project_ relation to be given to the newly added project. They must include values for the non-nullable attributes except the auto generated ones like the ID                                                                                                                       | `NULL`                                                                                                          |
| /user/:personId/project/:projId/isadmin                 | GET    | `IsAdmin(personId, projId)`                                  | `personId` : self-describing <br> `projId`: self-describing                                                                                                                                                                                                                                                                                                                                | `true` if this person is the admin of the project and `false` otherwise                                         |
| /user/:personId/project/:projId                         | POST   | `SetProjectId(personId, projId, data)`                       | `personId`: ID of the admin/owner of the project **(MUST BE THE ADMIN !!! )** <br> `projId`: ID of the project to edit <br>`data` : values for all or some attributes of the _Project_ relation to be given to the project to edit.                                                                                                                                                        | `true` if this person is the admin of the project and `false` otherwise                                         |
| /user/:peronId/project/:projId                          | DELETE | `DeleteProject(personId, projId)`                            | `personId`: ID of the admin/owner of the project **(MUST BE THE ADMIN !!! )** <br> `projId`: ID of the project to delete.                                                                                                                                                                                                                                                                  | `true` if this person is the admin of the project and `false` otherwise                                         |
| /user/:personId/project/:projId/contibutors             | POST   | `AddProjectContributor(personId, projId, contribId)`         | `personId`: ID of the admin/owner of the project **(MUST BE THE ADMIN !!! )** <br> `projId`: ID of the project to add contributor to <br> `contribId`: ID of the _Person_ to be added as contributor                                                                                                                                                                                       | `true` if this person is the admin of the project and `false` otherwise                                         |
| /user/:personId/project/:projId/contributors/:contribId | DELETE | `DeleteProjectContributor(personId, projId, contribId)`      | `personId`: ID of the admin/owner of the project **(MUST BE THE ADMIN !!! )** <br> `projId`: ID of the project to delete contributor for <br> `contribId`: ID of the _Person_ to be deleted as contributor                                                                                                                                                                                 | `true` if this person is the admin of the project and `false` otherwise                                         |
| /user/:personId/project/:projId/imgsVids                | POST   | `AddProjectImgVid(personId, projId, imgVidLink)`             | `personId`: ID of the admin/owner of the project **(MUST BE THE ADMIN !!! )** <br> `projId`: ID of the project to add contributor to <br> `imgVidLink`: link of the image/video to add to the project                                                                                                                                                                                      | `true` if this person is the admin of the project and `false` otherwise                                         |
| /user/:personId/project/:projId/imgsVids/:imgVidLink    | DELETE | `DeleteProjectImgVid(personId, projId, imgVidLink)`          | `personId`: ID of the admin/owner of the project **(MUST BE THE ADMIN !!! )** <br> `projId`: ID of the project to delete contributor for <br> `imgVidLink`: link of the image/video to be deleted                                                                                                                                                                                          | `true` if this person is the admin of the project and `false` otherwise                                         |
| /user/:id/min                                           | GET    | `GetUserDataMin(id)`                                         | `id`: _Person_ ID to get data of                                                                                                                                                                                                                                                                                                                                                           | Returns name, type, cv_link of the given user                                                                   |
| /user/:id/taskLists                                     | GET    | `GetUserTaskLists(id)`                                       | `id` of the owner to get TaskLists of                                                                                                                                                                                                                                                                                                                                                      | Returns _ListID_(s) owned by the given _Person_                                                                 |
| /user/:id/adminedUsers/                                 | GET    | `GetGiverUsers(giverId)`                                     | `id` of the owner to get TaskLists of                                                                                                                                                                                                                                                                                                                                                      | Returns IDs of the users assigned this giver as admin to any of their taskLists                                 |
| /user/:giverId/adminUsers/:userId/taskLists             | GET    | `GetGiverUserTaskLists(giverId, userId)`                     | `giverId`: ID of the person of type TaskGiver<br>`userId`: ID of another person who assigned the giver as an admin for some taskLists                                                                                                                                                                                                                                                      | Returns IDs of the TaskLists owned by the given user and admined by the given admin                             |
| /user/:personId/taskLists/:taskListId                   | GET    | `GetUserTaskList(personId, taskListId, adminId)`             | `personId`: ID of the owner of the taskList- **MUST BE THE OWNER**<br>`taskListId`: ID of the list we want to retreive info about<br>`adminId`: ID of the admin of this taskList, or `NULL` if the admin is the owner                                                                                                                                                                      | Returns data about the taskList (start_date, title, adminID)                                                    |
| /user/:personId/taskLists/:taskListId/tasks             | GET    | `GetUserTaskListTasks(personId, taskListId, adminId)`        | `personId`: ID of the owner of the taskList<br>`taskListId`: ID of the taskList to show tasks of<br>`adminId`: ID of the admin of this taskList, or `NULL` if the admin is the owner                                                                                                                                                                                                 | Returns IDs, title of the tasks given                                                                           |
| /user/:personId/taskLists/:taskListId/task/:taskId      | GET    | `GetUserTaskListTask(personId, taskListId, taskId, adminId)` | `personId`: ID of the owner of the taskList <br>`taskListId`: ID of the taskList<br>`taskId`: ID of the task to get information about<br>`adminId`: ID of the admin of this taskList, or `NULL` if the admin is the owner                                                                                                                                                                                                 | Returns data of a task in some taskList                                                                           |
| /user/:ownerId/taskLists/:taskListId/admin/:adminId     | POST   | `SetUserTaskListAdmin(ownerId, taskListId, adminId)`         | `ownerId`: ID of the owner of the ID - **MUST BE THE OWNER!!**<br> `taskListId`: ID of the taskList to add/overwrite admin for<br>`adminId`: ID of the person to set as admin to this taskList. If `NULL` is passed, the owner becomes the admin                                                                                                                                           | `true` if the person is the **owner**, `false` otherwise                                                        |
| /user/:id/taskLists/                                    | POST   | `AddUserTaskList(id, taskListData)`                                        | `id`: the id of the **owner** _Person_<br>`taskListData`: values for some of the taskList attributes with all non-nullables given                                                                                                                                                                                                                                                                                                                                                     | creates a new TaskList and makes the user the owner and the admin of it and returns `NULL`                      |
| /user/:id/taskLists/:taskListId                         | POST   | `EditUserTaskList(userId, taskListId, taskListData, adminId)`              | `userId`: ID of the TaskList owner<br>`taskListId`: ID of the TaskList<br>`taskListData`: values for some attributes of the _TaskList_ relation <br>`adminId`: ID of the admin to the taskList or `NULL` is the owner is himself the admin                                                                                                                                                                                                                          | `true` if the admin is authorized. `false` otherwise                                                            |
| /user/:id/taskLists/:taskListId                         | DELETE | `DeleteUserTaskList(userId, taskListId, adminId)`            | `userId`: ID of the TaskList owner<br>`taskListId`: ID of the TaskList <br>`adminId`: ID of the admin to the taskList or `NULL` is the owner is himself the admin                                                                                                                                                                                                                          | `true` if the admin is authorized. `false` otherwise                                                            |
| /user/:id/taskLists/:taskList/tasks                     | POST   | `AddUserTaskListTask(id, taskListId, adminId, taskData)`     | `id`: the id of the **owner** _Person_<br>`taskListId`: ID of the taskList to add a task to<br>`adminId`: ID of the admin to the taskList or `NULL` is the owner is himself the admin<br>`taskData`: values to some attributes to the _Task_ relation, all non-nulls will be given                                                                                                         | `true` if the admin is authorized. `false` otherwise                                                            |
| /user/:id/taskLists/:taskListId/tasks/:taskId           | POST   | `EditUserTaskListTask(userId, taskListId, taskId, taskData, adminId)`  | `userId`: ID of the TaskList owner<br>`taskListId`: ID of the TaskList <br>`taskId`: ID of the task to be edited<br>`taskData`: values for some attributes of the _Task_ relation<br>`adminId`: ID of the admin to the taskList or `NULL` is the owner is himself the admin                                                                                                                                                                                | `true` if the admin is authorized. `false` otherwise                                                            |
| /user/:id/taskLists/:taskListId/tasks/:taskId           | DELETE | `DeleteUserTaskList(userId, taskListId, taskId, adminId)`    | `userId`: ID of the TaskList owner<br>`taskListId`: ID of the TaskList <br>`taskId`: ID of the task to delete<br>`adminId`: ID of the admin to the taskList or `NULL` is the owner is himself the admin                                                                                                                                                                                                                          | `true` if the admin is authorized. `false` otherwise                                                            |
| /user/:id/Diseases                                      | GET    | `GetUserDiseases(id)`                                        | `id` of the person to get Diseases of                                                                                                                                                                                                                                                                                                                                                      | Returns _DiseaseID_(s) owned by the given _Person_                                                              |
| /user/:id/caredPatients/                                 | GET    | `GetDoctorPatients(doctorId)`                                     | `doctorId`: Doctor ID to get patients of                                                                                                                                                                                                                                                                                                                                                       | Returns IDs of the users assigned this doctor as care taker to any of their Diseases                                 |
| /user/:doctorId/caredPatients/:patientId/Diseases             | GET    | `GetDoctorPatientDiseases(doctorId, patientId)`                     | `doctorId`: ID of the person of type Doctor<br>`patientId`: ID of another person who assigned the doctor as care taker for some Diseases                                                                                                                                                                                                                                                      | Returns IDs of the Disease suffered by the given patient and cared by the given Doctor                             |
| /user/:patientId/diseases/:diseaseId                   | GET    | `GetPatientDisease(patientId, diseaseId, doctorId)`             | `patientId`: ID of the patient - **MUST BE THE OWNER**<br>`diseaseId`: ID of the disease we want to retreive info about<br>`doctorId`: ID of the Doctor of this Disease, or `NULL` if the doctor is the owner                                                                                                                                                                      | Returns data about the  suffering of this patient of the disease (name, start_date, end_date)                                                    |
| /user/:patientId/diseases/:diseaseId/medicineDoses             | GET    | `GetPatientDiseaseMedicineDoses(patientId, diseaseId, doctorId)`        | `patientId`: ID of the patient suffering from this disease<br>`diseaseId`: ID of the disease to show MedicineDoses of<br>`doctorId`: ID of the doctor of this disease of this patient, or `NULL` if the doctor is the patient ðŸ˜†                                                                                                                                                                                                 | Returns name, type of the medicineDoses of all the medicine doses assigned to this Disease by this patient                                                                           |
| /user/:patientId/diseases/:diseaseId/medicineDose/:medicineName      | GET    | `GetPatientDiseaseMedicineDose(patientId, diseaseId, medicineName, doctorId)` | `patientId`: ID of the patient<br>`diseaseId`: ID of the disease <br>`medicineName`: Name of the medicine to get info about <br>`doctorId`: ID of the doctor of this disease to this patient, or `NULL` if the doctor is the patient ðŸ˜†                                                                                                                                             | Returns values of all attributes of the _MedicineDose_ relation for the given (patient-disease) pair                                                                           |
| /user/:patientId/diseases/:diseaseId/doctor/:doctorId     | POST   | `SetUserTaskListAdmin(patientId, diseaseId, doctorId)`         | `patientId`: ID of the patient <br> `diseaseId`: ID of the disease to add/overwrite doctor to this patient<br>`doctorId`: ID of the person to set as doctor to this disease to this petient. If `NULL` is passed, the patient becomes the doctor                                                                                                                                           | `true` if this patient/disease pair is found, `false` otherwise                                                        |
| /user/:id/diseases/                                    | POST   | `AddPatientDisease(id, diseaseId)`                                        | `id`: the id of the _Patient_ to add Disease to<br>`diseaseId`: ID of the disease to add to this patient.                                                                                                                                                                                                                                                                                                                                                     | assigns a disease to a petient                      |
| /user/:id/diseases/:diseaseId                         | POST   | `EditPatientDisease(patientId, diseaseId, doctorId)`              | `patientId`: ID of the patient<br>`diseaseId`: ID of the Disease<br>`doctorId`: ID of the doctor to the disease or `NULL` is the doctor is himself the patient                                                                                                                                                                                                                          | `true` if the doctor is authorized. `false` otherwise                                                            |
| /user/:id/diseases/:diseaseId                         | DELETE | `DeleteUserTaskList(patientId, diseaseId, doctorId)`            | `patientId`: ID of the Patient<br>`diseaseId`: ID of the Disease <br>`doctorId`: ID of the doctor to this patient and disease or `NULL` is the patient is himself the doctor                                                                                                                                                                                                                          | `true` if the admin is authorized. `false` otherwise                                                            |
| /user/:id/diseases/:diseaseId/medicineDoses                     | POST   | `AddPatientDiseaseMedicineDose(id, diseaseId, doctorId, doseData)`     | `id`: the id of the **patient** _Person_<br>`diseaseId`: ID of the disease to add a medicineDose to<br>`doctorId`: ID of the doctor to this patient to this disease or `NULL` is the patient is himself the doctor<br>`doseData`: values to some attributes to the _MedicineDose_ relation, all non-nullables will be given                                                                                                         | `true` if the doctor is authorized. `false` otherwise                                                            |
| /user/:id/diseases/:diseaseId/medicineDoses/:doseId           | POST   | `EditPatientDiseaseMedicineDose(patientId, diseaseId, doseName, doctorId, doseData)`  | `patientId`: ID of the patient <br>`diseaseId`: ID of the Disease <br>`doseName`: name of the dose to be edited<br>`doctorId`: ID of the doctor to the disease to this patient or `NULL` is the patient is himself the doctor<br>`doseData`: values for some attributes of the _MedicineDose_ relation to overwrite the existing values for this record                                                                                                                                                                                | `true` if the doctor is authorized. `false` otherwise                                                            |
| /user/:id/diseases/:diseaseId/medicineDoses/:doseName           | DELETE | `DeletePatientDiseaseMedicineDose(patientId, diseaseId, doseName, doctorId)`    | `patientId`: ID of the Patient<br>`diseaseId`: ID of the Disease<br>`doseName`: name of the dose to be deleted <br>`doctorId`: ID of the doctor to the disease to this patient or `NULL` is the patient is himself the doctor                                                                                                                                                                                                                          | `true` if the doctor is authorized. `false` otherwise                                                            |
| /diseases | GET | `GetDiseases()` | `NULL` | IDs and Names of all the diseases in the DB|
| /diseases/:diseaseId | GET | `GetDisease(diseaseId)` | `diseaseId`: ID of the disease we want to get info about | All info about the disease + some stats to be stated|
| /rests | GET | GetRests() | `NULL` | RestIDs and Names of all the Rests in the DB |
| /user/:userId/rest | POST | `AddUserRest(restId, userId, restData)` | `restId`: ID of the rest to be added to the person<br>`userId`: ID of the user to add rest to<br>`restData`: values to some of the attributes of _Person\_Takes\_Rest_ relation with all non-nullables given | `NULL`
| /user/:userId/rest/:restID | GetUserRest(restId, userId) | `restId`: ID of the rest to get info about<br>`userId`: ID of the user who takes this rest | Values of the attributes of _Person\_Takes\_Rest_ relation to this record|
| /user/:userId/rest/:restId | POST | `EditUserRest(restId, userId, restData)` | `restId`: ID of the rest to be edited to the person<br>`userId`: ID of the user to edit rest of<br>`restData`: values to some of the attributes of _Person\_Takes\_Rest_ relation | `NULL`
| /user/:userId/rest/:restId | DELETE | `DeleteUserRest(restId, userId)` | `restId`: ID of the rest to be deleted from the person<br>`userId`: ID of the user to delete rest of| `NULL`
| /habit | GET | GetHabit() | `NULL` | RestIDs and Names of all the Habits in the DB |
| /user/:userId/habit | POST | `AddUserHabit(habitName, userId, habitData)` | `habitName`: Name of the habit to be added to the person<br>`userId`: ID of the user to add habit to<br>`habitData`: values to some of the attributes of _Person\_has\_Habit_ relation with all non-nullables given | `NULL`
| /user/:userId/habit/:habitName | GetUserHabit(habitName, userId) | `habitName`: Name of the habit to get info about<br>`userId`: ID of the user who has this habit | Values of the attributes of _Person\_has\_Habit_ relation to this record|
| /user/:userId/habit/:habitName | POST | `EditUserHabit(habitName, userId, habitData)` | `habitName`: Name of the habit to be edited to the person<br>`userId`: ID of the user to edit habit of<br>`habitData`: values to some of the attributes of _Person\_has\_Habit_ relation | `NULL`
| /user/:userId/habit/:habitName | DELETE | `DeleteUserhabit(habitName, userId)` | `habitName`: Name of the habit to be deleted from the person<br>`userId`: ID of the user to delete habit of| `NULL`

## Notes

- For tasks, diseases and sports, insure that the admin is authorized if its ID is given in any of the Procedures
- Add _medicineName_ as an attribute (partial key) to the _MedicineDose_. Sorry, I forgot to write this ðŸ˜…